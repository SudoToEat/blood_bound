# 鲜血盟约 - 多设备访问指南

## 功能概述

鲜血盟约网页版现已支持多设备访问功能，让每个玩家可以通过自己的手机查看自己的身份和阵营，无需传递设备或暴露自己的身份信息。

## 使用流程

### 主持人（房主）操作流程

1. 在主设备（如电脑或平板）上打开游戏
2. 选择玩家人数（6-12人）
3. 点击"下一步：创建房间"按钮
4. 在房间设置页面，点击"创建房间"按钮
5. 系统会生成一个6位数的房间号和每个玩家的访问链接/二维码
6. 让每位玩家通过以下方式之一访问自己的身份：
   - 扫描对应的二维码
   - 点击"复制链接"按钮，将链接发送给对应玩家
7. 确认所有玩家都已查看自己的身份后，点击"开始游戏"按钮

### 玩家操作流程

1. 通过主持人提供的链接或扫描二维码访问游戏
2. 页面会自动显示你的角色身份、阵营和能力说明
3. 游戏过程中保持页面打开，随时查看自己的身份信息

## 测试功能

为了方便测试多设备访问功能，我们提供了一个测试页面：

1. 访问 `[游戏URL]?test=true`
2. 测试页面会自动创建一个6人游戏的房间
3. 点击任意玩家链接，可以在新窗口中查看该玩家的身份

## 注意事项

- 确保所有设备都连接到同一个网络
- 如果使用本地开发服务器，其他设备需要通过局域网IP访问
- 房间信息存储在浏览器本地，刷新页面可能导致数据丢失
- 主持人设备需要保持页面打开，直到游戏结束

## 常见问题解决方案

### 连接问题

#### 无法连接到游戏服务器
- 确保所有设备都连接到同一个Wi-Fi网络
- 避免使用移动数据网络
- 检查防火墙设置，确保开放端口3000和5173
- 查看页面顶部的连接状态提示

#### 连接状态显示"连接错误"
- 刷新页面重新连接
- 检查服务器是否正常运行
- 确认使用的IP地址正确
- 查看浏览器控制台的错误信息

### 访问问题

#### "找不到ID为X的玩家" 错误
如果您在访问玩家链接时看到此错误，可能是由于：

- **游戏未开始**：主持人还未点击"开始游戏"
- **房间ID不匹配**：使用的链接中房间号不正确
- **网络问题**：WebSocket连接未建立成功

#### 解决方法：

1. **确认游戏状态**：
   - 确认主持人已点击"开始游戏"
   - 等待房间创建完成

2. **重新获取链接**：
   - 主持人重新点击对应玩家的「复制链接」按钮
   - 将新链接发送给玩家

3. **检查网络连接**：
   - 确保所有设备都连接到同一个Wi-Fi网络
   - 查看连接状态栏（页面顶部）
   - 如显示"连接错误"，尝试刷新页面

### 二维码显示问题

如果二维码无法正常显示或扫描失败：

- **刷新页面**：有时候二维码可能未正确加载，刷新页面可能解决问题
- **调整屏幕亮度**：提高屏幕亮度可以提高二维码的可读性
- **使用文本链接**：如果二维码扫描失败，可以使用「复制链接」按钮获取文本链接
- **更新浏览器**：确保使用最新版本的浏览器
- **检查网络连接**：确保网络连接稳定

## 技术说明

多设备访问功能通过以下方式实现：

- **WebSocket实时同步**：使用Socket.IO实现实时游戏状态同步
- **房间管理**：通过后端API管理房间和玩家
- **二维码访问**：使用qrcode库生成访问二维码
- **连接监控**：实时显示连接状态和玩家在线情况
- **路由管理**：使用React Router处理不同页面
- **URL参数**：通过URL传递房间ID和玩家ID
- **访问代码**：每个玩家有唯一的访问代码

## 更新日志

### v2.0.0 (2025-01)
- ✅ 添加WebSocket实时同步
- ✅ 实现房间管理系统
- ✅ 添加连接状态监控
- ✅ 优化多设备访问体验

### v1.5.0 (2024-12)
- ✅ 实现多设备访问功能
- ✅ 添加二维码生成

---

**最后更新**: 2025年1月
**版本**: v2.0.0